<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/26.2.15 Chrome/134.0.6998.205 Electron/35.2.1 Safari/537.36" version="26.2.15">
  <diagram name="Page-1" id="DwfBp3Bx95xUx9JLIW2q">
    <mxGraphModel dx="2837" dy="1227" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="J8khblfrpPTMTR6dcxoA-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-1" target="J8khblfrpPTMTR6dcxoA-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-1" target="J8khblfrpPTMTR6dcxoA-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-1" value="&lt;font&gt;(batch_size, q_len/kv_len, hidden_size=7168)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="80" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-4" target="J8khblfrpPTMTR6dcxoA-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-4" value="(hidden_size, kv_lora_rank + qk_rope_head_dim=576)" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="590" y="150" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-5" target="J8khblfrpPTMTR6dcxoA-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-5" target="J8khblfrpPTMTR6dcxoA-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-5" value="&lt;font&gt;(batch_size, kv_len, kv_lora_rank+qk_rope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="545" y="290" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-6" target="J8khblfrpPTMTR6dcxoA-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-6" value="&lt;font&gt;(batch_size, kv_len, qk_rope_head_dim=64)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="300" y="440" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-7" target="J8khblfrpPTMTR6dcxoA-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-7" value="&lt;font&gt;(batch_size, kv_len, kv_lora_rank=512)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="870" y="440" width="300" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-8" target="J8khblfrpPTMTR6dcxoA-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-8" target="J8khblfrpPTMTR6dcxoA-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-8" value="(batch_size, num_key_value_heads *&lt;div&gt;(qk_nope_head_dim + qk_rope_head_dim))&lt;/div&gt;&lt;div&gt;(bs, 128 * (128 + 128))&lt;/div&gt;" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="860" y="590" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-10">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="469.99999999999955" y="900" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-10" value="&lt;font&gt;(batch_size, kv_len, num_key_value_heads, qk_nope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="545" y="750" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-11" target="J8khblfrpPTMTR6dcxoA-20">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1260" y="1160" />
              <mxPoint x="755" y="1160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-11" value="&lt;font&gt;(batch_size, kv_len, num_key_value_heads, qk_nope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="1055" y="750" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-60" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-12" target="J8khblfrpPTMTR6dcxoA-19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="470" y="1000" />
              <mxPoint x="50" y="1000" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-12" value="&lt;font&gt;(batch_size, kv_len, num_key_value_heads, qk_rope_head_dim + qk_nope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="265" y="870" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-13" target="J8khblfrpPTMTR6dcxoA-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-13" value="(hidden_size, q_lora_rank)&lt;div&gt;(7168, 1546)&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%22%26lt%3Bfont%26gt%3B(batch_size%2C%20q_len%2Fkv_len%2C%20hidden_size%3D7168)%26lt%3B%2Ffont%26gt%3B%22%20style%3D%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23f5f5f5%3BstrokeColor%3D%23666666%3BfontColor%3D%23333333%3BfontSize%3D15%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%2280%22%20width%3D%22340%22%20height%3D%2270%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;/div&gt;" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-320" y="150" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-14" target="J8khblfrpPTMTR6dcxoA-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-14" value="(batch_size, q_len, q_lora_rank)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-330" y="290" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-15" target="J8khblfrpPTMTR6dcxoA-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-15" target="J8khblfrpPTMTR6dcxoA-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-15" value="(q_lora_rank, num_attention_heads *&lt;div&gt;(qk_rope_head_dim + qk_nope_head_dim)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;(1536, 128*(128+64))&lt;/div&gt;" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-320" y="420" width="320" height="130" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-53" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-16" target="J8khblfrpPTMTR6dcxoA-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-16" value="(batch_size, q_len, num_attention_heads, qk_rope_head_dim)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-550" y="640" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-17" target="J8khblfrpPTMTR6dcxoA-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-17" value="(batch_size, q_len, num_attention_heads,&amp;nbsp;&lt;div&gt;qk_nope_head_dim)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-140" y="640" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-59" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-18" target="J8khblfrpPTMTR6dcxoA-19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-160" y="1000" />
              <mxPoint x="50" y="1000" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-18" value="(batch_size, q_len, num_attention_heads,&amp;nbsp;&lt;div&gt;qk_nope_head_dim + qk_rope_head_dim)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-350" y="820" width="380" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-19" target="J8khblfrpPTMTR6dcxoA-20">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="50" y="1160" />
              <mxPoint x="755" y="1160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-19" value="&lt;font&gt;(batch_size, num_attention_heads,&lt;/font&gt;&lt;div&gt;&lt;font&gt;q_len, kv_len)&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-120" y="1050" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-64" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-20" target="J8khblfrpPTMTR6dcxoA-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-20" value="&lt;font&gt;(batch_size, q_len, num_attention_heads,&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;font&gt;qk_nop&lt;/font&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%22%26lt%3Bfont%26gt%3B(batch_size%2C%20kv_len%2C%20kv_lora_rank%2Bqk_rope_head_dim)%26lt%3B%2Ffont%26gt%3B%22%20style%3D%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23f5f5f5%3BstrokeColor%3D%23666666%3BfontColor%3D%23333333%3BfontSize%3D15%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22560%22%20y%3D%22310%22%20width%3D%22410%22%20height%3D%2270%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;e_head_dim)&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="550" y="1240" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-66" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-21" target="J8khblfrpPTMTR6dcxoA-65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-21" value="(batch_size, q_len, num_heads * qk_nope_head_dim)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=15;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="550" y="1390" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-34" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;wkv_a = (&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;wkv_a_k_rope,&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;wkv_nope)&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="940" y="121" width="190" height="89" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-35" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;k_pe + compress kv&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="970" y="271" width="190" height="89" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-36" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;compressed kv&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1190" y="440" width="190" height="69.5" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-37" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;k_pe&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="640" y="450.13" width="70" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-38" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;wkv_b = wk_b + wv_b&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1190" y="590" width="200" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-39" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;k_nope&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="540" y="700.13" width="120" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-40" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;v&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1345" y="700.13" width="120" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-42" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;add_rope&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="475" y="560" width="125" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-43" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;k&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="675" y="910.06" width="55" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-46" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;wq_a&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-430" y="160.13" width="70" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-47" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;compressed q&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-490" y="300.06" width="150" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-49" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;wq_b = (wq_b_rope, wq_b_nope)&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-560" y="445" width="190" height="80" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-52" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;concat&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="350" y="780" width="120" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-55" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;add rope&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-540" y="730.13" width="150" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-56" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;q_pe&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-590" y="590.13" width="150" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-57" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;q_nope&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="60" y="590" width="150" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-58" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;concat&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="30" y="829.87" width="150" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-61" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;MHA&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-10" y="950" width="150" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-62" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;attention weights&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-280" y="1060.06" width="150" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-63" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;softmax &amp;amp; multiply&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="610" y="1109.93" width="310" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-70" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="J8khblfrpPTMTR6dcxoA-65" target="J8khblfrpPTMTR6dcxoA-67">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-65" value="(num_heads * qk_nope_head_dim,&lt;div&gt;hiiden_size)&lt;/div&gt;" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="595" y="1530" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-67" value="(batch_size, q_len, hiiden_size)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=15;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="592.5" y="1680" width="325" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-68" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;attn&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="480" y="1250.06" width="70" height="49.87" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-69" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;o_proj&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="490" y="1540.07" width="70" height="49.87" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
