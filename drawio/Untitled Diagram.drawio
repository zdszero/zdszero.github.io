<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/26.2.15 Chrome/134.0.6998.205 Electron/35.2.1 Safari/537.36" version="26.2.15">
  <diagram name="Page-1" id="DwfBp3Bx95xUx9JLIW2q">
    <mxGraphModel dx="2728" dy="1145" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="J8khblfrpPTMTR6dcxoA-1" value="&lt;font&gt;(batch_size, q_len/kv_len, hidden_size=7168)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="80" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-4" value="(hidden_size, kv_lora_rank + qk_rope_head_dim=576)" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="590" y="150" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-5" value="&lt;font&gt;(batch_size, kv_len, kv_lora_rank+qk_rope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="560" y="310" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-6" value="&lt;font&gt;(batch_size, kv_len, qk_rope_head_dim=64)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="210" y="440" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-7" value="&lt;font&gt;(batch_size, kv_len, kv_lora_rank=512)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="780" y="440" width="300" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-8" value="(batch_size, num_key_value_heads *&lt;div&gt;(qk_nope_head_dim + qk_rope_head_dim))&lt;/div&gt;&lt;div&gt;(bs, 128 * (128 + 128))&lt;/div&gt;" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="770" y="600" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-10" value="&lt;font&gt;(batch_size, kv_len, num_key_value_heads, qk_nope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="450" y="750" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-11" value="&lt;font&gt;(batch_size, kv_len, num_key_value_heads, qk_nope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="960" y="750" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-12" value="&lt;font&gt;(batch_size, kv_len, num_key_value_heads, qk_rope_head_dim + qk_nope_head_dim)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="175" y="900" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-13" value="(hidden_size, q_lora_rank)&lt;div&gt;(7168, 1546)&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%22%26lt%3Bfont%26gt%3B(batch_size%2C%20q_len%2Fkv_len%2C%20hidden_size%3D7168)%26lt%3B%2Ffont%26gt%3B%22%20style%3D%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23f5f5f5%3BstrokeColor%3D%23666666%3BfontColor%3D%23333333%3BfontSize%3D15%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%2280%22%20width%3D%22340%22%20height%3D%2270%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;/div&gt;" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-320" y="150" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-14" value="(batch_size, q_len, q_lora_rank)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-330" y="290" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-15" value="(q_lora_rank, num_attention_heads *&lt;div&gt;(qk_rope_head_dim + qk_nope_head_dim)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;(1536, 128*(128+64))&lt;/div&gt;" style="shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rotation=0;fillColor=#fff2cc;strokeColor=default;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-320" y="420" width="320" height="130" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-16" value="(batch_size, q_len, num_attention_heads, qk_rope_head_dim)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-540" y="600" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-17" value="(batch_size, q_len, num_attention_heads,&amp;nbsp;&lt;div&gt;qk_nope_head_dim)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-130" y="600" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-18" value="(batch_size, q_len, num_attention_heads,&amp;nbsp;&lt;div&gt;qk_nope_head_dim + qk_rope_head_dim)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-340" y="740" width="380" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-19" value="&lt;font&gt;(batch_size, num_attention_heads,&lt;/font&gt;&lt;div&gt;&lt;font&gt;q_len, kv_len)&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-120" y="1050" width="340" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-20" value="&lt;font&gt;(batch_size, q_len, num_attention_heads,&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;font&gt;qk_nop&lt;/font&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start; text-wrap-mode: nowrap; background-color: transparent;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%22%26lt%3Bfont%26gt%3B(batch_size%2C%20kv_len%2C%20kv_lora_rank%2Bqk_rope_head_dim)%26lt%3B%2Ffont%26gt%3B%22%20style%3D%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23f5f5f5%3BstrokeColor%3D%23666666%3BfontColor%3D%23333333%3BfontSize%3D15%3B%22%20vertex%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22560%22%20y%3D%22310%22%20width%3D%22410%22%20height%3D%2270%22%20as%3D%22geometry%22%2F%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;e_head_dim)&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="560" y="1170" width="410" height="70" as="geometry" />
        </mxCell>
        <mxCell id="J8khblfrpPTMTR6dcxoA-21" value="(batch_size, q_len, num_heads * qk_nope_head_dim)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=15;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="560" y="1320" width="410" height="70" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
